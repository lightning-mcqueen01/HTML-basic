const questionBank = {
  Science: [
    {
      question:
        "Which vitamin is produced in the human skin when exposed to sunlight?",
      options: ["Vitamin A", "Vitamin B", "Vitamin C", "Vitamin D"],
      answer: "Vitamin D",
      hint: "Essential for bone health.",
    },
    {
      question: "What is the center of an atom called?",
      options: ["Electron", "Proton", "Neutron", "Nucleus"],
      answer: "Nucleus",
      hint: "It contains protons and neutrons.",
    },
    {
      question: "Which gas do humans primarily breathe in?",
      options: ["Oxygen", "Carbon Dioxide", "Nitrogen", "Helium"],
      answer: "Oxygen",
      hint: "Essential for respiration.",
    },
    {
      question: "What is the boiling point of water at sea level?",
      options: ["90°C", "100°C", "110°C", "120°C"],
      answer: "100°C",
      hint: "It is a common scientific benchmark.",
    },
    {
      question: "Which organ pumps blood throughout the human body?",
      options: ["Lungs", "Brain", "Liver", "Heart"],
      answer: "Heart",
      hint: "It has four chambers.",
    },
    {
      question: "What is the hardest natural substance on Earth?",
      options: ["Gold", "Iron", "Diamond", "Quartz"],
      answer: "Diamond",
      hint: "It is made of carbon atoms.",
    },
    {
      question: "Which element is essential for bones and teeth?",
      options: ["Iron", "Calcium", "Magnesium", "Sodium"],
      answer: "Calcium",
      hint: "Found in dairy products.",
    },
    {
      question: "Which part of the human body controls all functions?",
      options: ["Heart", "Lungs", "Brain", "Stomach"],
      answer: "Brain",
      hint: "It processes thoughts and movements.",
    },
    {
      question: "What is the largest planet in the solar system?",
      options: ["Earth", "Jupiter", "Saturn", "Neptune"],
      answer: "Jupiter",
      hint: "It has a Great Red Spot.",
    },
    {
      question: "Which gas is needed for fire to burn?",
      options: ["Oxygen", "Carbon Dioxide", "Nitrogen", "Hydrogen"],
      answer: "Oxygen",
      hint: "It supports combustion.",
    },
    {
      question: "What force keeps us on the ground?",
      options: ["Magnetism", "Gravity", "Friction", "Electricity"],
      answer: "Gravity",
      hint: "Discovered by Isaac Newton.",
    },
    {
      question: "What part of the plant conducts photosynthesis?",
      options: ["Roots", "Stem", "Leaves", "Flowers"],
      answer: "Leaves",
      hint: "They contain chlorophyll.",
    },
    {
      question: "What is the smallest unit of life?",
      options: ["Tissue", "Organ", "Cell", "Molecule"],
      answer: "Cell",
      hint: "Basic building block of organisms.",
    },
    {
      question: "Which is the longest bone in the human body?",
      options: ["Femur", "Humerus", "Tibia", "Fibula"],
      answer: "Femur",
      hint: "It is in the leg.",
    },
    {
      question: "What is Earth's only natural satellite?",
      options: ["Mars", "Venus", "Moon", "Sun"],
      answer: "Moon",
      hint: "It causes tides on Earth.",
    },
  ],
  History: [
    {
      question: "Who was the first President of the United States?",
      options: [
        "Abraham Lincoln",
        "George Washington",
        "Thomas Jefferson",
        "John Adams",
      ],
      answer: "George Washington",
      hint: "He appears on the one-dollar bill.",
    },
    {
      question: "Which year did World War II end?",
      options: ["1940", "1945", "1950", "1939"],
      answer: "1945",
      hint: "It ended with the surrender of Japan.",
    },
    {
      question: "Which ancient civilization built the pyramids?",
      options: ["Romans", "Greeks", "Egyptians", "Mayans"],
      answer: "Egyptians",
      hint: "They were known for their pharaohs.",
    },
    {
      question: "Who discovered America in 1492?",
      options: [
        "Christopher Columbus",
        "Marco Polo",
        "Vasco da Gama",
        "Ferdinand Magellan",
      ],
      answer: "Christopher Columbus",
      hint: "He sailed with the Nina, Pinta, and Santa Maria.",
    },
    {
      question:
        "Which war was fought between the North and South regions of the United States?",
      options: [
        "Revolutionary War",
        "World War I",
        "The Civil War",
        "Cold War",
      ],
      answer: "The Civil War",
      hint: "It was mainly about slavery and state's rights.",
    },
    {
      question: "Which country gifted the Statue of Liberty to the USA?",
      options: ["Germany", "France", "Canada", "United Kingdom"],
      answer: "France",
      hint: "This European country also has the Eiffel Tower.",
    },
    {
      question: "Who was the first Emperor of China?",
      options: ["Qin Shi Huang", "Genghis Khan", "Confucius", "Sun Tzu"],
      answer: "Qin Shi Huang",
      hint: "He unified China and built parts of the Great Wall.",
    },
    {
      question: "What year did the Titanic sink?",
      options: ["1912", "1905", "1898", "1920"],
      answer: "1912",
      hint: "It hit an iceberg on its maiden voyage.",
    },
    {
      question: "Which empire was ruled by Julius Caesar?",
      options: [
        "Greek Empire",
        "Roman Empire",
        "Persian Empire",
        "Ottoman Empire",
      ],
      answer: "Roman Empire",
      hint: "It had gladiators and a Colosseum.",
    },
    {
      question:
        "Who was the British Prime Minister during most of World War II?",
      options: [
        "Winston Churchill",
        "Neville Chamberlain",
        "Margaret Thatcher",
        "Tony Blair",
      ],
      answer: "Winston Churchill",
      hint: "He was famous for his inspiring wartime speeches.",
    },
    {
      question: "Who was the first President of the United States?",
      options: [
        "Abraham Lincoln",
        "George Washington",
        "Thomas Jefferson",
        "John Adams",
      ],
      answer: "George Washington",
      hint: "He appears on the one-dollar bill.",
    },
    {
      question: "Which year did World War II end?",
      options: ["1940", "1945", "1950", "1939"],
      answer: "1945",
      hint: "It ended with the surrender of Japan.",
    },
    {
      question: "Which ancient civilization built the pyramids?",
      options: ["Romans", "Greeks", "Egyptians", "Mayans"],
      answer: "Egyptians",
      hint: "They were known for their pharaohs.",
    },
    {
      question: "Who discovered America in 1492?",
      options: [
        "Christopher Columbus",
        "Marco Polo",
        "Vasco da Gama",
        "Ferdinand Magellan",
      ],
      answer: "Christopher Columbus",
      hint: "He sailed with the Nina, Pinta, and Santa Maria.",
    },
    {
      question:
        "Which war was fought between the North and South regions of the United States?",
      options: [
        "Revolutionary War",
        "World War I",
        "The Civil War",
        "Cold War",
      ],
      answer: "The Civil War",
      hint: "It was mainly about slavery and state's rights.",
    },
  ],
  Math: [
    {
      question: "What is the value of π (pi) approximately?",
      options: ["3.14", "2.72", "1.62", "4.13"],
      answer: "3.14",
      hint: "It's commonly used in circle calculations.",
    },
    {
      question: "What is 15 × 6?",
      options: ["75", "80", "90", "60"],
      answer: "90",
      hint: "Multiply 15 by 5, then add 15 more.",
    },
    {
      question: "What is the square root of 64?",
      options: ["6", "7", "8", "9"],
      answer: "8",
      hint: "It's a perfect square between 5 and 10.",
    },
    {
      question: "What is the result of 7²?",
      options: ["42", "49", "56", "64"],
      answer: "49",
      hint: "Multiply 7 by itself.",
    },
    {
      question:
        "If a triangle has angles of 60° and 60°, what is the third angle?",
      options: ["30°", "60°", "90°", "45°"],
      answer: "60°",
      hint: "The sum of a triangle’s angles is always 180°.",
    },
    {
      question: "What is 144 divided by 12?",
      options: ["10", "11", "12", "13"],
      answer: "12",
      hint: "Think of the multiplication table of 12.",
    },
    {
      question: "What is the perimeter of a square with a side length of 5 cm?",
      options: ["15 cm", "20 cm", "25 cm", "30 cm"],
      answer: "20 cm",
      hint: "Perimeter of a square is 4 × side length.",
    },
    {
      question: "What is 25% of 200?",
      options: ["50", "40", "25", "30"],
      answer: "50",
      hint: "Divide by 4 to get 25% of a number.",
    },
    {
      question: "How many sides does a hexagon have?",
      options: ["4", "5", "6", "7"],
      answer: "6",
      hint: "It's more than a pentagon but less than a heptagon.",
    },
    {
      question: "What is 7 + 8 × 2?",
      options: ["30", "22", "15", "25"],
      answer: "23",
      hint: "Follow BODMAS rule (Order of Operations).",
    },
    {
      question: "What is the cube of 3?",
      options: ["9", "12", "27", "18"],
      answer: "27",
      hint: "Multiply 3 by itself three times.",
    },
    {
      question:
        "A right triangle has a base of 6 and a height of 8. What is its hypotenuse?",
      options: ["10", "12", "8", "14"],
      answer: "10",
      hint: "Use the Pythagorean theorem (a² + b² = c²).",
    },
    {
      question: "What is the next prime number after 7?",
      options: ["9", "10", "11", "13"],
      answer: "11",
      hint: "Prime numbers have only two factors: 1 and itself.",
    },
    {
      question: "If 3x + 5 = 14, what is the value of x?",
      options: ["3", "4", "5", "6"],
      answer: "3",
      hint: "Solve for x by isolating it on one side.",
    },
    {
      question: "What is the sum of the angles in a quadrilateral?",
      options: ["360°", "180°", "270°", "450°"],
      answer: "360°",
      hint: "A quadrilateral is made of two triangles.",
    },
  ],
};

let score = 0,
  questionLeft = 10,
  hintLeft = 3,
  questions = [],
  timer,
  liner;

let topRanks = [];

let topRankers = localStorage.getItem("topRankers");
if (topRankers == null) {
  localStorage.setItem("topRankers", JSON.stringify([]));
} else {
  topRanks = JSON.parse(localStorage.getItem("topRankers"));
  showTopRanks();
}

function showTopRanks() {
  document.getElementById("topList").innerHTML = "";
  topRanks.forEach((ranker) => {
    const item = document.createElement("li");
    const scoreVal = document.createElement("span");
    scoreVal.textContent = ranker.score;
    item.innerHTML = ranker.name;
    item.appendChild(scoreVal);

    item.classList.add("rank-item");
    document.getElementById("topList").appendChild(item);
    console.log(item);
  });
}

function checkInfo() {
  if (document.getElementById("name").value == "") {
    alert("Please enter your name");
    return;
  }
  if (document.getElementById("category").value == "") {
    alert("Please select a category");
    return;
  }

  startQuiz();
}

function startQuiz() {
  score = 0;
  questionLeft = 10;
  const category = document.getElementById("category").value;
  questions = questionBank[category];
  document.getElementById("start-screen").style.display = "none";
  document.getElementById("quiz-screen").style.display = "block";
  loadQuestion();
}

function loadQuestion() {
  clearInterval(timer);
  clearInterval(liner);
  let timeLeft = 15;
  const timeLine = document.getElementById("time-line");
  timeLine.style.width = "100%";
  // timeLine.style.transition = "2.5s";
  document.getElementById("countDown").innerText = timeLeft;
  timer = setInterval(() => {
    timeLeft--;
    document.getElementById("countDown").innerText = timeLeft;
    if (timeLeft <= 0) {
      clearInterval(timer);
      nextQuestion();
    }
  }, 1000);

  // const progress = (timeLeft / 150) * 100;
  let progress = 15000;
  liner = setInterval(() => {
    progress -= 10;
    timeLine.style.width = `${progress / 150}%`;
  }, 10);

  const randomNum = Math.floor(Math.random() * 15);
  const q = questions[randomNum];
  document.getElementById("question-box").innerHTML = q.question;
  document.getElementById("hint-text").style.display = "none";
  const answer = document.getElementById("answer-box");
  answer.innerHTML = "";
  q.options.forEach((option) => {
    const button = document.createElement("button");
    button.innerText = option;
    button.classList.add("option-btn", "option");
    button.onclick = () => checkAnswer(button, option, q.answer);
    answer.appendChild(button);
  });
  document.getElementById("hint-text").innerHTML = q.hint;
  document.getElementById("hint-num").innerHTML = hintLeft;
}

function checkAnswer(button, selected, answer) {
  clearInterval(timer);
  clearInterval(liner);
  if (selected === answer) {
    button.classList.add("correct");
    score += 50;
  } else {
    button.classList.add("incorrect");
    document.querySelectorAll(".option").forEach((option) => {
      if (option.textContent === answer) {
        option.classList.add("correct");
      }
    });
  }
  setTimeout(() => {
    nextQuestion();
  }, 2000);
}

function nextQuestion() {
  if (questionLeft > 0) {
    loadQuestion();
    questionLeft--;
  } else {
    quitQuiz();
  }
}

function insertInTopRanks(ranker) {
  let i = topRanks.length;

  if (i == 0) topRanks.push(ranker);

  while (i - 1 >= 0 && topRanks[i - 1].score < ranker.score) i--;

  topRanks.splice(i, 0, ranker);

  if (topRanks.length > 5) topRanks.pop();

  // console.log(topRanks);
}

//  Quit funtion

function quitQuiz() {
  clearInterval(timer);
  clearInterval(liner);
  document.getElementById("score").innerHTML = score;
  let resultModal = new bootstrap.Modal(document.getElementById("resultModal"));
  resultModal.show();
  let ranker = {
    name: document.getElementById("name").value,
    score: score,
  };
  insertInTopRanks(ranker);
  localStorage.setItem("topRankers", JSON.stringify(topRanks));
  showTopRanks();
}

function showHint() {
  if (hintLeft > 0) {
    document.getElementById("hint-text").style.display = "block";
    hintLeft--;
  }
}

function restartQuiz() {
  document.getElementById("quiz-screen").style.display = "none";
  document.getElementById("start-screen").style.display = "block";
  document.getElementById("name").value = "";
  document.getElementById("category").value = "";
  document.querySelectorAll(".cat-btn").style.backgroundColor = "white";
}

function catScience() {
  document.getElementById("category").value = "Science";
  document.querySelector(".btn-math").style.backgroundColor = "white";
  document.querySelector(".btn-history").style.backgroundColor = "white";
  document.querySelector(".btn-science").style.backgroundColor = "#FF961F";
  console.log(document.getElementById("category").value);
}
function catMath() {
  document.getElementById("category").value = "Math";
  console.log(document.getElementById("category").value);
  document.querySelector(".btn-history").style.backgroundColor = "white";
  document.querySelector(".btn-science").style.backgroundColor = "white";
  document.querySelector(".btn-math").style.backgroundColor = "#FF961F";
}
function catHistory() {
  document.getElementById("category").value = "History";
  console.log(document.getElementById("category").value);
  document.querySelector(".btn-math").style.backgroundColor = "white";
  document.querySelector(".btn-science").style.backgroundColor = "white";
  document.querySelector(".btn-history").style.backgroundColor = "#FF961F";
}

function changeTheme() {
  let checkbox = document.getElementById("theme");
  let instruction = document.querySelector(".instructions");
  let body = document.body;

  let themeLabel = document.querySelector(".theme-label");
  // let light = document.createElement();

  if (checkbox.checked) {
    themeLabel.innerHTML = `<img src="moon-icon-512x512-fm9crgpt.png" alt="" class="w-100"
              />`;
    document.getElementById("resultModal").style.color = "#0C3A45";
    body.style.backgroundColor = "#0C3A45";
    body.style.color = "#fff";
    instruction.style.color = "#0C3A45";
    // table.style.backgroundColor = "#000";
    // chart.style.backgroundColor = "#000";
  } else {
    themeLabel.innerHTML = `<img src="9055356.png" alt="" class="w-100"
              />`;
    body.style.backgroundColor = "#fff";
    body.style.color = "#000";
  }
}
